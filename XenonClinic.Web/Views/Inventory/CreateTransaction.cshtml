@using Microsoft.AspNetCore.Mvc.Localization
@using XenonClinic.Core.Enums
@inject IViewLocalizer Localizer
@model XenonClinic.Web.Models.CreateInventoryTransactionViewModel
@{
    ViewData["Title"] = Localizer["NewTransaction"];
}

<h2 class="mb-3">@Localizer["NewInventoryTransaction"]</h2>

<form asp-action="CreateTransaction" method="post" class="card card-rounded p-3 p-md-4">
    <div asp-validation-summary="ModelOnly" class="text-danger"></div>

    <div class="row g-3">
        <!-- Inventory Item -->
        <div class="col-md-6 col-12">
            <label asp-for="InventoryItemId" class="form-label">@Localizer["InventoryItem"]</label>
            <select asp-for="InventoryItemId" class="form-select" asp-items="ViewBag.Items">
                <option value="">@Localizer["SelectItem"]</option>
            </select>
            <span asp-validation-for="InventoryItemId" class="text-danger"></span>
        </div>

        <!-- Transaction Type -->
        <div class="col-md-6 col-12">
            <label asp-for="TransactionType" class="form-label">@Localizer["TransactionType"]</label>
            <select asp-for="TransactionType" class="form-select">
                @foreach (InventoryTransactionType type in Enum.GetValues(typeof(InventoryTransactionType)))
                {
                    <option value="@type">@type.ToString()</option>
                }
            </select>
            <span asp-validation-for="TransactionType" class="text-danger"></span>
        </div>

        <!-- Transaction Date -->
        <div class="col-md-4 col-sm-6 col-12">
            <label asp-for="TransactionDate" class="form-label">@Localizer["TransactionDate"]</label>
            <input asp-for="TransactionDate" type="datetime-local" class="form-control" />
            <span asp-validation-for="TransactionDate" class="text-danger"></span>
        </div>

        <!-- Quantity -->
        <div class="col-md-4 col-sm-6 col-12">
            <label asp-for="Quantity" class="form-label">@Localizer["Quantity"]</label>
            <input asp-for="Quantity" type="number" class="form-control" />
            <span asp-validation-for="Quantity" class="text-danger"></span>
            <small class="text-muted">@Localizer["QuantityHelp"]</small>
        </div>

        <!-- Unit Price -->
        <div class="col-md-4 col-sm-6 col-12">
            <label asp-for="UnitPrice" class="form-label">@Localizer["UnitPrice"]</label>
            <input asp-for="UnitPrice" type="number" step="0.01" class="form-control" />
            <span asp-validation-for="UnitPrice" class="text-danger"></span>
        </div>

        <!-- Reference Number -->
        <div class="col-md-6 col-12">
            <label asp-for="ReferenceNumber" class="form-label">@Localizer["ReferenceNumber"]</label>
            <input asp-for="ReferenceNumber" class="form-control" placeholder="@Localizer["InvoiceOrPONumber"]" />
            <span asp-validation-for="ReferenceNumber" class="text-danger"></span>
        </div>

        <!-- Patient (for Sale or Return) -->
        <div class="col-md-6 col-12">
            <label asp-for="PatientId" class="form-label">@Localizer["Patient"]</label>
            <select asp-for="PatientId" class="form-select" asp-items="ViewBag.Patients">
                <option value="">@Localizer["SelectPatient"]</option>
            </select>
            <span asp-validation-for="PatientId" class="text-danger"></span>
            <small class="text-muted">@Localizer["RequiredForSaleOrReturn"]</small>
        </div>

        <!-- Transfer To Branch (for Transfer) -->
        <div class="col-md-6 col-12">
            <label asp-for="TransferToBranchId" class="form-label">@Localizer["TransferToBranch"]</label>
            <select asp-for="TransferToBranchId" class="form-select" asp-items="ViewBag.Branches">
                <option value="">@Localizer["SelectBranch"]</option>
            </select>
            <span asp-validation-for="TransferToBranchId" class="text-danger"></span>
            <small class="text-muted">@Localizer["RequiredForTransfer"]</small>
        </div>

        <!-- Notes -->
        <div class="col-12">
            <label asp-for="Notes" class="form-label">@Localizer["Notes"]</label>
            <textarea asp-for="Notes" class="form-control" rows="3"></textarea>
            <span asp-validation-for="Notes" class="text-danger"></span>
        </div>
    </div>

    <div class="mt-4 d-flex flex-column flex-sm-row justify-content-end gap-2">
        <a asp-action="Index" class="btn btn-outline-secondary">@Localizer["Cancel"]</a>
        <button type="submit" class="btn btn-xenon">@Localizer["Save"]</button>
    </div>
</form>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
