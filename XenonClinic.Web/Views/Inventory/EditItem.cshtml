@using Microsoft.AspNetCore.Mvc.Localization
@using XenonClinic.Core.Enums
@inject IViewLocalizer Localizer
@model XenonClinic.Web.Models.CreateInventoryItemViewModel
@{
    ViewData["Title"] = Localizer["EditItem"];
    var itemId = ViewBag.ItemId;
}

<h2 class="mb-3">@Localizer["EditInventoryItem"]</h2>

<form asp-action="EditItem" asp-route-id="@itemId" method="post" class="card card-rounded p-3 p-md-4">
    <div asp-validation-summary="ModelOnly" class="text-danger"></div>

    <div class="row g-3">
        <!-- Item Code -->
        <div class="col-md-4 col-12">
            <label asp-for="ItemCode" class="form-label">@Localizer["ItemCode"]</label>
            <input asp-for="ItemCode" class="form-control" />
            <span asp-validation-for="ItemCode" class="text-danger"></span>
        </div>

        <!-- Name -->
        <div class="col-md-8 col-12">
            <label asp-for="Name" class="form-label">@Localizer["Name"]</label>
            <input asp-for="Name" class="form-control" />
            <span asp-validation-for="Name" class="text-danger"></span>
        </div>

        <!-- Description -->
        <div class="col-12">
            <label asp-for="Description" class="form-label">@Localizer["Description"]</label>
            <textarea asp-for="Description" class="form-control" rows="2"></textarea>
            <span asp-validation-for="Description" class="text-danger"></span>
        </div>

        <!-- Category -->
        <div class="col-md-4 col-sm-6 col-12">
            <label asp-for="Category" class="form-label">@Localizer["Category"]</label>
            <select asp-for="Category" class="form-select">
                @foreach (InventoryCategory cat in Enum.GetValues(typeof(InventoryCategory)))
                {
                    <option value="@cat">@cat.ToString()</option>
                }
            </select>
            <span asp-validation-for="Category" class="text-danger"></span>
        </div>

        <!-- Branch (disabled for editing) -->
        <div class="col-md-4 col-sm-6 col-12">
            <label class="form-label">@Localizer["Branch"]</label>
            <select asp-for="BranchId" class="form-select" asp-items="ViewBag.Branches" disabled>
            </select>
            <input type="hidden" asp-for="BranchId" />
            <small class="text-muted">@Localizer["BranchCannotBeChanged"]</small>
        </div>

        <!-- Supplier -->
        <div class="col-md-4 col-sm-6 col-12">
            <label asp-for="SupplierId" class="form-label">@Localizer["Supplier"]</label>
            <select asp-for="SupplierId" class="form-select" asp-items="ViewBag.Suppliers">
                <option value="">@Localizer["SelectSupplier"]</option>
            </select>
            <span asp-validation-for="SupplierId" class="text-danger"></span>
        </div>

        <!-- Current Quantity (display only) -->
        <div class="col-md-3 col-sm-6 col-12">
            <label class="form-label">@Localizer["CurrentQuantity"]</label>
            <input type="number" value="@Model.QuantityOnHand" class="form-control" disabled />
            <small class="text-muted">@Localizer["UseTransactionsToChangeStock"]</small>
        </div>

        <!-- Reorder Level -->
        <div class="col-md-3 col-sm-6 col-12">
            <label asp-for="ReorderLevel" class="form-label">@Localizer["ReorderLevel"]</label>
            <input asp-for="ReorderLevel" type="number" class="form-control" />
            <span asp-validation-for="ReorderLevel" class="text-danger"></span>
        </div>

        <!-- Max Stock Level -->
        <div class="col-md-3 col-sm-6 col-12">
            <label asp-for="MaxStockLevel" class="form-label">@Localizer["MaxStockLevel"]</label>
            <input asp-for="MaxStockLevel" type="number" class="form-control" />
            <span asp-validation-for="MaxStockLevel" class="text-danger"></span>
        </div>

        <!-- Cost Price -->
        <div class="col-md-3 col-sm-6 col-12">
            <label asp-for="CostPrice" class="form-label">@Localizer["CostPrice"]</label>
            <input asp-for="CostPrice" type="number" step="0.01" class="form-control" />
            <span asp-validation-for="CostPrice" class="text-danger"></span>
        </div>

        <!-- Selling Price -->
        <div class="col-md-3 col-sm-6 col-12">
            <label asp-for="SellingPrice" class="form-label">@Localizer["SellingPrice"]</label>
            <input asp-for="SellingPrice" type="number" step="0.01" class="form-control" />
            <span asp-validation-for="SellingPrice" class="text-danger"></span>
        </div>

        <!-- Supplier Part Number -->
        <div class="col-md-3 col-sm-6 col-12">
            <label asp-for="SupplierPartNumber" class="form-label">@Localizer["SupplierPartNumber"]</label>
            <input asp-for="SupplierPartNumber" class="form-control" />
            <span asp-validation-for="SupplierPartNumber" class="text-danger"></span>
        </div>

        <!-- Barcode -->
        <div class="col-md-3 col-sm-6 col-12">
            <label asp-for="Barcode" class="form-label">@Localizer["Barcode"]</label>
            <input asp-for="Barcode" class="form-control" />
            <span asp-validation-for="Barcode" class="text-danger"></span>
        </div>

        <!-- Location -->
        <div class="col-md-3 col-sm-6 col-12">
            <label asp-for="Location" class="form-label">@Localizer["Location"]</label>
            <input asp-for="Location" class="form-control" />
            <span asp-validation-for="Location" class="text-danger"></span>
        </div>

        <!-- Expiry Date -->
        <div class="col-md-3 col-sm-6 col-12">
            <label asp-for="ExpiryDate" class="form-label">@Localizer["ExpiryDate"]</label>
            <input asp-for="ExpiryDate" type="date" class="form-control" />
            <span asp-validation-for="ExpiryDate" class="text-danger"></span>
        </div>

        <!-- Notes -->
        <div class="col-12">
            <label asp-for="Notes" class="form-label">@Localizer["Notes"]</label>
            <textarea asp-for="Notes" class="form-control" rows="2"></textarea>
            <span asp-validation-for="Notes" class="text-danger"></span>
        </div>

        <!-- Is Active -->
        <div class="col-12">
            <div class="form-check">
                <input asp-for="IsActive" class="form-check-input" type="checkbox" />
                <label asp-for="IsActive" class="form-check-label">@Localizer["IsActive"]</label>
            </div>
        </div>
    </div>

    <input type="hidden" asp-for="QuantityOnHand" />

    <div class="mt-4 d-flex flex-column flex-sm-row justify-content-end gap-2">
        <a asp-action="Items" class="btn btn-outline-secondary">@Localizer["Cancel"]</a>
        <button type="submit" class="btn btn-xenon">@Localizer["Save"]</button>
    </div>
</form>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
